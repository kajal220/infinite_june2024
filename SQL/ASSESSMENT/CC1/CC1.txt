use  Assignment_2

-- 1.Write a query to display your birthday( day of week)
	  select datename(weekday,'2001-04-22') as week_day

--2.Write a query to display your age in days
    select datediff(day,'2001-04-22', getdate()) as age_in_days

--3.Write a query to display all employees information those who joined before 5 years in the current month
--(Hint : If required update some HireDates in your EMP table

select * from emp 
where hiredate < dateadd(year, 5, cast(getdate() as date))



--4.Create table Employee with empno, ename, sal, doj columns and perform the following operations in a single transaction
 --a.First insert 3 rows 
 --b.Update the second row sal with 15% increment  
 --c.Delete first row.
 --After completing above all actions how to recall the deleted row without losing increment of second row.

create table Employee (
    empno int primary key,
    ename varchar(50),
    sal float,
    doj Date
)

begin transaction
--a.inserting 3 rows
insert into  Employee (empno, ename, sal, doj) values
(101, 'kajal shukla', 45000, '2024-07-01'),(102, 'abcd', 70000, '2026-09-17'),
(103, 'palak', 70000, '2026-07-09')

 --b. Update the second row salary with 15% increment
update Employee set sal = sal * 1.15
where empno = 102

--c.Delete the first row
 delete from Employee where empno = 101
  
 commit
 
-- Retrieve the deleted row
select * from Employee

 
--5. Create a user defined function calculate Bonus for all employees of a  given job using 	following conditions
--a. For Deptno 10 employees 15% of sal as bonus.
--b. For Deptno 20 employees  20% of sal as bonus
--c. For Others employees 5%of sal as bonus
create or alter function CalculateBonus(@Deptno int) 
returns float
as
begin
    declare @bonus float
    declare @sal float
    if @Deptno = 10 
    begin
        set @bonus = 0.15 * @Sal
    end
    else if @Deptno = 20 
    begin
        set @bonus = 0.20 * @Sal
    end
    else
    begin
        set @bonus = 0.05 * @Sal
    end
    
    return @bonus
end

Select empno,ename, dbo.CalculateBonus(10) as bonus from EMP

 



