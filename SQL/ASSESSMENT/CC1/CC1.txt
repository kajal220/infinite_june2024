use  Assignment_2

-- 1.Write a query to display your birthday( day of week)
	  select datename(weekday,'2001-04-22') as week_day

--2.Write a query to display your age in days
    select datediff(day,'2001-04-22', getdate()) as age_in_days

--3.Write a query to display all employees information those who joined before 5 years in the current month
--(Hint : If required update some HireDates in your EMP table

select*from EMP
		update EMP set HireDate = '2019-07-17' where Empno = 7934
		update EMP set HireDate = '2019-07-20' where Empno = 7369
		update EMP set HireDate = '2019-07-3' where Empno = 7782
		update EMP set HireDate = '2019-07-9' where Empno = 7698
 
	select * from EMP where DATEDIFF(yy,hiredate,GETDATE()) = 5 and month(hiredate)=month(getdate());



--4.Create table Employee with empno, ename, sal, doj columns and perform the following operations in a single transaction
 --a.First insert 3 rows 
 --b.Update the second row sal with 15% increment  
 --c.Delete first row.
 --After completing above all actions how to recall the deleted row without losing increment of second row.

Create Table Employee (
            EmpNo int PRIMARY KEY,
            EName varchar(50),
            Sal float,
            DOJ DATE )
			
			
     Begin transaction
	 --a. First insert 3 rows
         Insert into Employee Values (101, 'kajal', 30000, '2022-04-09'), (102, 'palak', 50000, '2021-06-06'),
       (103, 'abcd', 20000, '2020-08-03')

        -- b. Update the second row sal with 15% increment
         Update Employee Set Sal = Sal * 1.15
         where Empno = 102
        
         save tran t1

        -- c. Delete first row
         Delete From Employee 
         where empno = 101

	
         
        --Recalling the deleted row without loosing increment of second row
         rollback tran t1

         Commit

	 Select * from  employee


 
--5. Create a user defined function calculate Bonus for all employees of a  given job using 	following conditions
--a. For Deptno 10 employees 15% of sal as bonus.
--b. For Deptno 20 employees  20% of sal as bonus
--c. For Others employees 5%of sal as bonus
create or alter function Calculate_Bonus(@Salary float, @DeptNo int)
returns float
as
begin
declare @Bonus float
if (@DeptNo = 10)
set @Bonus = @Salary * 0.15
else if (@DeptNo = 20)
set @Bonus = @Salary * 0.20
else
set @Bonus = @Salary * 0.05
return @Bonus
end
--calling the function
select empno, ename, sal, hiredate, dbo.Calculate_Bonus(sal, deptno) as Bonus
from EMP
where deptno = 10

 